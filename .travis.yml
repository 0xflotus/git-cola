# Travis CI(http://travis-ci.org) configuration file
language: python
python:
  - "2.7"
  - "3.4"
#  https://docs.travis-ci.com/user/languages/python/
#  We use apt to avoid having to build PyQt ourselves, so that means
#  we can only use the default python versions available in Ubuntu.
#  For Trusty, that's 2.7.6 and 3.4.3.
virtualenv:
  system_site_packages: true

addons:
  apt:
    packages:
      # git and python are pre-installed
      # according to Debian control file from Ubuntu 12.04
      - rsync
      - gettext
      # Runtime dependencies
      - python-qt4
      - python3-pyqt5
      # Build/test dependencies
      - python-sphinx
      - python3-sphinx
      - pylint

before_install:
  # Git test setup
  - git config --global user.name "Git Cola"
  - git config --global user.email git-cola@localhost.localdomain

install:
  # Build dependencies
  - make requirements
  # Test dependencies
  - make requirements-dev

script:
  - make all
  - make test V=2
  - make doc
  - pylint --version
  - test "2.7" != "$TRAVIS_PYTHON_VERSION" || make pylint
  - make pylint3k
  - flake8 --version
  - make flake8
